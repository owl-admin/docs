"use strict";(self.webpackChunkrspress_doc_template=self.webpackChunkrspress_doc_template||[]).push([["1611"],{4141:function(e,n,r){r.r(n),r.d(n,{default:function(){return c}});var a=r(2676),s=r(453);function h(e){let n=Object.assign({h1:"h1",a:"a",h3:"h3",pre:"pre",code:"code",p:"p",em:"em",h5:"h5",strong:"strong"},(0,s.ah)(),e.components);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(n.h1,{id:"模型关联数据展示",children:[(0,a.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#模型关联数据展示",children:"#"}),"模型关联数据展示"]}),"\n",(0,a.jsxs)(n.h3,{id:"假设你定义了这么一个关联",children:[(0,a.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#假设你定义了这么一个关联",children:"#"}),"假设你定义了这么一个关联"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-php",meta:"",children:"public function branch()\n{\n    return $this->belongsTo(Branch::class);\n}\n"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsxs)(n.em,{children:["如果你连模型关联都没玩明白, 建议先通读并背诵 ",(0,a.jsx)(n.a,{href:"https://learnku.com/docs/laravel/9.x/eloquent-relationships/12252",rel:"noopener noreferrer",target:"_blank",children:"文档"})," ~"]})}),"\n",(0,a.jsxs)(n.h3,{id:"现在你需要在列表中或者详情中回显",children:[(0,a.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#现在你需要在列表中或者详情中回显",children:"#"}),"现在你需要在列表中或者详情中回显"]}),"\n",(0,a.jsxs)(n.h5,{id:"更改-service-中的查询",children:[(0,a.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#更改-service-中的查询",children:"#"}),"更改 Service 中的查询"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-php",meta:"",children:"// 列表中\npublic function listQuery()\n{\n    $model = $this->getModel();\n\n    // 原本的查询长这样\n    // return $this->query()->orderByDesc($model->getUpdatedAtColumn());\n\n    // 现在你需要改成这样, 预加载 branch 关联\n    return $this->query()->with('branch')->orderByDesc($model->getUpdatedAtColumn());\n}\n\n// 详情中\npublic function getDetail($id)\n{\n    // 原本的查询长这样\n    // return $this->query()->find($id);\n\n    // 现在你需要改成这样, 预加载 branch 关联\n    return $this->query()->with('branch')->find($id);\n}\n"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.em,{children:"更改查询后, 你的数据将从一维变成二维"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-php",meta:"",children:"// 直观一点看\n\n// 原本数据长这样\n[\n    'id' => 1,\n    'name' => '张三',\n    'branch_id' => 1,\n]\n\n// 现在数据长这样\n[\n    'id' => 1,\n    'name' => '张三',\n    'branch_id' => 1,\n    'branch' => [\n        'id' => 1,\n        'name' => '总部',\n    ],\n]\n"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsxs)(n.em,{children:["如果你连数据结构为什么变成这样都有点蒙圈, 建议先通读并背诵 ",(0,a.jsx)(n.a,{href:"https://learnku.com/docs/laravel/9.x/eloquent-relationships/12252#012e7e",rel:"noopener noreferrer",target:"_blank",children:"文档"})," ~"]})}),"\n",(0,a.jsxs)(n.h3,{id:"现在你需要在列表中或者详情中回显-1",children:[(0,a.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#现在你需要在列表中或者详情中回显-1",children:"#"}),"现在你需要在列表中或者详情中回显"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-php",meta:"",children:"// 列表中\n// ...\n// 你现在可以通过 . 的方式取到多个层级的数据\nTableColumn::make()->name('branch.name')->label('所属分公司'),\n// ...\n\n// 详情中\n// ...\n// 你现在可以通过 . 的方式取到多个层级的数据\nTextControl::make()->static(true)->name('branch.name')->label('所属分公司'),\n// ...\n"})}),"\n",(0,a.jsxs)(n.h3,{id:"为什么可以这么玩",children:[(0,a.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#为什么可以这么玩",children:"#"}),"为什么可以这么玩?"]}),"\n",(0,a.jsxs)(n.p,{children:["这里你需要先了解一下 ",(0,a.jsx)(n.code,{children:"amis"})," 中的 ",(0,a.jsx)(n.strong,{children:"数据域"})," 概念:\n",(0,a.jsx)(n.a,{href:"https://aisuda.bce.baidu.com/amis/zh-CN/docs/concepts/datascope-and-datachain",rel:"noopener noreferrer",target:"_blank",children:"https://aisuda.bce.baidu.com/amis/zh-CN/docs/concepts/datascope-and-datachain"})]})]})}function d(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,s.ah)(),e.components);return n?(0,a.jsx)(n,Object.assign({},e,{children:(0,a.jsx)(h,e)})):h(e)}let c=d;d.__RSPRESS_PAGE_META={},d.__RSPRESS_PAGE_META["guide%2Fexamples%2Fmodel-relation.md"]={toc:[{id:"假设你定义了这么一个关联",text:"假设你定义了这么一个关联",depth:3},{id:"现在你需要在列表中或者详情中回显",text:"现在你需要在列表中或者详情中回显",depth:3},{id:"现在你需要在列表中或者详情中回显-1",text:"现在你需要在列表中或者详情中回显",depth:3},{id:"为什么可以这么玩",text:"为什么可以这么玩?",depth:3}],title:"模型关联数据展示",frontmatter:{}}}}]);